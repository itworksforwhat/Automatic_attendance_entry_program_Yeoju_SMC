# 근태 자동 입력 v4.0

근태 자동 입력 시스템
걍 일하기 싫어서 만들었음

## 🎯 주요 기능

### 1. 데이터 분석
- **공휴일 자동 감지**: 출근 인원 분석으로 공휴일 자동 판단
- **근무 패턴 학습**: 데이터에서 정상 근무일 패턴 추출
- **이전 근무일 자동 검색**: 월요일, 공휴일 다음 날 자동 처리

## 📦 설치

### 1. 필수 패키지 설치
```bash
pip install -r requirements.txt
```

### 2. pywin32 설치 확인
```bash
pip install pywin32
```

## 🚀 사용 방법

### 1. 프로그램 실행
```bash
python main.py
```

### 2. 파일 선택
- 원시 데이터 파일 (.xls 또는 .xlsx)
- 여주 근태표 파일
- SMC 근태표 파일

### 3. 날짜 입력
- 기준 날짜 (YYYY-MM-DD)

### 4. 실행
- "실행" 버튼 클릭

### 5. 문제 데이터 처리 (있는 경우)
- `문제_데이터_확인.xlsx` 파일 열기
- 수정_출근, 수정_퇴근 컬럼 수정
- 저장 후 "재입력" 버튼 클릭

## 📁 파일 구조

```
attendance_v3/
├── main.py              # 메인 실행
├── config.py           # 설정
├── data_analyzer.py    # 데이터 분석 (핵심)
├── excel_com.py        # Excel COM 핸들러
├── attendance_engine.py # 출퇴근 로직
├── gui.py              # GUI
├── logger.py           # 로깅
├── models.py           # 데이터 모델
└── requirements.txt    # 필수 패키지
```

## 🔍 공휴일 자동 감지

### 알고리즘
1. 날짜별 출근 인원 계산
2. 평균 출근 인원 계산
3. 임계값 설정: 평균의 30%
4. 임계값 이하인 날짜 → 공휴일

### 예시
```
평균 출근: 45명
임계값: 13.5명 (30%)

12월 25일: 2명 출근 → 공휴일 감지
1월 1일: 0명 출근 → 공휴일 감지
```

## 📊 문제 데이터 유형

- `출근만 있음 (퇴근 누락)`
- `퇴근만 있음 (출근 누락)`
- `시간 형식 오류`
- `퇴근이 출근보다 빠름`

## 🎨 로그 예시

```
10:00:00 [INFO] ============================================================
10:00:00 [INFO] 근태 자동 입력 v3.0 시작
10:00:00 [INFO] ============================================================
10:00:01 [INFO] 1단계: 원시 데이터 로드
10:00:01 [SUCCESS] 파일 로드 완료: 138행
10:00:02 [INFO] 2단계: 데이터 분석
10:00:02 [SUCCESS] 패턴 분석 완료:
10:00:02 [INFO]   평균 출근 인원: 45.3명
10:00:02 [INFO]   공휴일 임계값: 13.6명 (30%)
10:00:02 [INFO]   근무일: 20일
10:00:02 [INFO]   공휴일: 2일
10:00:02 [INFO]   주말: 8일
10:00:02 [INFO] 감지된 공휴일:
10:00:02 [INFO]   - 2025-12-25 (2명 출근)
10:00:03 [INFO] 3단계: 데이터 검증
10:00:03 [SUCCESS] 데이터 검증 완료:
10:00:03 [INFO]   정상: 42건
10:00:03 [WARNING]   문제: 3건
```

## ⚙️ 설정 변경

### config.py

```python
# 공휴일 감지 임계값 (평균 출근의 30%)
HOLIDAY_THRESHOLD = 0.3

# 최소 출근 인원 (이하면 공휴일 의심)
MIN_ATTENDANCE = 5

# 블록 설정
YEOJU_BLOCKS = [...]
SMC_BLOCKS = [...]

# 지울 범위
CLEAR_RANGES_YEOJU = [...]
CLEAR_RANGES_SMC = [...]
```

## 🐛 문제 해결

### pywin32 설치 오류
```bash
pip install --upgrade pywin32
python -m win32com.client.makepy
```

### .xls 파일 읽기 오류
```bash
pip install xlrd==2.0.1
```

### COM 오류
- Excel 프로그램이 설치되어 있는지 확인
- 관리자 권한으로 실행

## 📈 v2.x와의 차이점

| 항목 | v2.x | v3.0 |
|------|------|------|
| 파일 수 | 14개 | **8개** |
| 공휴일 | 수동 입력 | **자동 감지** |
| .xls 처리 | 변환 필요 | **직접 읽기** |
| 문제 데이터 | 무시/오류 | **사용자 수정** |
| 로그 | 보통 | **매우 상세** |
| 구조 | 복잡 | **간결** |

## 📄 라이선스

내부 사용 전용

## 👤 개발

근태 관리 자동화 시스템 v4.0
